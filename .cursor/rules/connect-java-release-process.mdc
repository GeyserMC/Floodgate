---
description: 'Connect Java plugin release process and versioning workflow'
---

# Connect Java Release Process

This rule documents the complete release workflow for Connect Java plugins across all platforms (Velocity, BungeeCord, Spigot/Paper).

## Current Release Configuration

- **Release Branch**: `connect`
- **Current Version**: Check [build.gradle.kts](mdc:build.gradle.kts) line 9
- **Platforms**: Velocity, BungeeCord, Spigot/Paper
- **Automation**: GitHub Actions via [release.yml](mdc:.github/workflows/release.yml)

## Release Artifacts

Each release produces these platform-specific JARs:

- **`connect-spigot.jar`** - For Spigot/Paper servers
- **`connect-velocity.jar`** - For Velocity proxy
- **`connect-bungee.jar`** - For BungeeCord proxy

Built via shadow plugin configuration in [connect.shadow-conventions.gradle.kts](mdc:build-logic/src/main/kotlin/connect.shadow-conventions.gradle.kts).

## Release Types

### 1. Versioned Release (Tag-based)

**Trigger**: Push git tag matching `*.*.*` pattern
**Creates**:

- GitHub release with tag name (e.g., `0.7.0`)
- JARs named `connect-{platform}-{version}.jar`
- Updates `latest` release tag
- Standard JARs named `connect-{platform}.jar`

### 2. Pre-release (Branch-based)

**Trigger**: Push to `connect` branch without tag
**Creates**:

- GitHub pre-release with `latest-prerelease` tag
- JARs named `connect-{platform}-prerelease.jar`

## Step-by-Step Release Process

### 1. Pre-Release Checks

```bash
# Ensure all platforms build successfully
./gradlew build

# Verify all fixes are working:
# - Velocity: no event loop incompatibilities
# - BungeeCord: no "channel not registered" errors
# - Spigot/Paper: no IllegalAccessException on handshake
```

### 2. Version Update

Edit [build.gradle.kts](mdc:build.gradle.kts):

```kotlin
allprojects {
    group = "com.minekube.connect"
    version = "0.7.0" // Update this line
    // ...
}
```

### 3. Commit and Push Changes

```bash
git add build.gradle.kts
git commit -m "Release version 0.7.0"
git push origin connect
```

### 4. Create Release via GitHub UI

1. Go to `https://github.com/minekube/connect-java/releases`
2. Click **"Create a new release"**
3. **Tag**: Enter `0.7.0` (GitHub will create the tag automatically)
4. **Target**: Select `connect` branch
5. **Title**: `Connect Java 0.7.0`
6. **Description**: Add any specific release notes (optional - workflow will handle artifacts)
7. Click **"Publish release"**

This triggers the release workflow, creates the tag, and ensures all artifacts are properly uploaded.

### 5. Monitor Release

- Check GitHub Actions workflow completion
- Verify 3 releases created:
  1. **Your created release** (`0.7.0`) - The one you just created via UI
  2. **Latest release** (`latest`) - Auto-updated by workflow
  3. **Latest tag pointer** - Points to your new version

## GitHub Actions Workflow

The [release.yml](mdc:.github/workflows/release.yml) workflow:

**Environment**:

- Ubuntu latest
- JDK 17 (Temurin distribution)
- Gradle build action

**Build Process**:

1. Checkout code
2. Setup Java and Gradle
3. Run `./gradlew build`
4. Copy JARs from `{platform}/build/libs/connect-{platform}.jar`
5. Create releases with appropriate naming

**Release Logic**:

- **Tag push**: Creates versioned + latest releases
- **Branch push**: Creates pre-release only

## Version Numbering

**Pattern**: `MAJOR.MINOR.PATCH` (semantic versioning)

- **MAJOR**: Breaking changes to injection or API
- **MINOR**: New platform support, significant features
- **PATCH**: Bug fixes, compatibility updates

**Recent versions**: 0.6.2 â†’ 0.7.0 (next)

## Release Verification

After release, verify:

1. **GitHub Releases**: All 3 releases created with correct JARs
2. **JAR Integrity**: Download and verify JAR file sizes/contents
3. **Platform Testing**:
   - Deploy to test servers
   - Verify injection works without errors
   - Test player connections through Connect network

## Rollback Process

If release has critical issues:

```bash
# Delete problematic tag
git tag -d 0.7.0
git push origin :refs/tags/0.7.0

# Delete GitHub releases manually via web interface
# Fix issues and re-release with patch version (0.7.1)
```

## Pre-Release Testing

For testing unreleased changes:

1. Push to `connect` branch (without tag)
2. Use JARs from `latest-prerelease` release
3. Test on staging environments
4. When stable, create official release tag

## Common Release Issues

- **Build failures**: Check Java/Gradle compatibility in workflow
- **Missing JARs**: Verify shadow plugin configuration
- **Wrong versions**: Ensure [build.gradle.kts](mdc:build.gradle.kts) version updated
- **Tag conflicts**: Delete and recreate tags if needed

## GitHub UI Benefits

**Why GitHub UI is required:**

- **Workflow Compatibility**: The [release.yml](mdc:.github/workflows/release.yml) workflow requires a GitHub release to exist for artifact uploads (lines 82-90)
- **Automatic tag creation**: GitHub creates and manages the tag when you publish the release
- **Rich release notes**: Better formatting and editing experience with markdown preview
- **Release management**: Easy to edit, delete, or mark as pre-release later
- **Immediate visibility**: Release appears instantly in GitHub UI for users to download
